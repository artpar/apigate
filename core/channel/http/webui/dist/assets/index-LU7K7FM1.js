var Kt=t=>{throw TypeError(t)};var yt=(t,e,r)=>e.has(t)||Kt("Cannot "+r);var i=(t,e,r)=>(yt(t,e,"read from private field"),r?r.call(t):e.get(t)),N=(t,e,r)=>e.has(t)?Kt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),g=(t,e,r,n)=>(yt(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),S=(t,e,r)=>(yt(t,e,"access private method"),r);var ct=(t,e,r,n)=>({set _(a){g(t,e,a,r)},get _(){return i(t,e,n)}});import{r as f,a as Bs,O as Hs,N as gt,L as K,R as qt,u as js,b as It,B as Ks,c as Ws,d as ee,e as Oe}from"./vendor-BEEOvD6K.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();var ws={exports:{}},ft={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zs=f,Vs=Symbol.for("react.element"),Gs=Symbol.for("react.fragment"),Js=Object.prototype.hasOwnProperty,Ys=zs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Xs={key:!0,ref:!0,__self:!0,__source:!0};function Ns(t,e,r){var n,a={},o=null,l=null;r!==void 0&&(o=""+r),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(l=e.ref);for(n in e)Js.call(e,n)&&!Xs.hasOwnProperty(n)&&(a[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)a[n]===void 0&&(a[n]=e[n]);return{$$typeof:Vs,type:t,key:o,ref:l,props:a,_owner:Ys.current}}ft.Fragment=Gs;ft.jsx=Ns;ft.jsxs=Ns;ws.exports=ft;var s=ws.exports,vt={},Wt=Bs;vt.createRoot=Wt.createRoot,vt.hydrateRoot=Wt.hydrateRoot;var Ge=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Zs={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},ce,Tt,us,er=(us=class{constructor(){N(this,ce,Zs);N(this,Tt,!1)}setTimeoutProvider(t){g(this,ce,t)}setTimeout(t,e){return i(this,ce).setTimeout(t,e)}clearTimeout(t){i(this,ce).clearTimeout(t)}setInterval(t,e){return i(this,ce).setInterval(t,e)}clearInterval(t){i(this,ce).clearInterval(t)}},ce=new WeakMap,Tt=new WeakMap,us),je=new er;function tr(t){setTimeout(t,0)}var Fe=typeof window>"u"||"Deno"in globalThis;function _(){}function sr(t,e){return typeof t=="function"?t(e):t}function jt(t){return typeof t=="number"&&t>=0&&t!==1/0}function Cs(t,e){return Math.max(t+(e||0)-Date.now(),0)}function ge(t,e){return typeof t=="function"?t(e):t}function H(t,e){return typeof t=="function"?t(e):t}function zt(t,e){const{type:r="all",exact:n,fetchStatus:a,predicate:o,queryKey:l,stale:c}=t;if(l){if(n){if(e.queryHash!==Dt(l,e.options))return!1}else if(!Ze(e.queryKey,l))return!1}if(r!=="all"){const h=e.isActive();if(r==="active"&&!h||r==="inactive"&&h)return!1}return!(typeof c=="boolean"&&e.isStale()!==c||a&&a!==e.state.fetchStatus||o&&!o(e))}function Vt(t,e){const{exact:r,status:n,predicate:a,mutationKey:o}=t;if(o){if(!e.options.mutationKey)return!1;if(r){if(Ae(e.options.mutationKey)!==Ae(o))return!1}else if(!Ze(e.options.mutationKey,o))return!1}return!(n&&e.state.status!==n||a&&!a(e))}function Dt(t,e){return((e==null?void 0:e.queryKeyHashFn)||Ae)(t)}function Ae(t){return JSON.stringify(t,(e,r)=>wt(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function Ze(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(r=>Ze(t[r],e[r])):!1}var rr=Object.prototype.hasOwnProperty;function ks(t,e){if(t===e)return t;const r=Gt(t)&&Gt(e);if(!r&&!(wt(t)&&wt(e)))return e;const a=(r?t:Object.keys(t)).length,o=r?e:Object.keys(e),l=o.length,c=r?new Array(l):{};let h=0;for(let x=0;x<l;x++){const v=r?x:o[x],u=t[v],y=e[v];if(u===y){c[v]=u,(r?x<a:rr.call(t,v))&&h++;continue}if(u===null||y===null||typeof u!="object"||typeof y!="object"){c[v]=y;continue}const p=ks(u,y);c[v]=p,p===u&&h++}return a===l&&h===a?t:c}function xt(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function Gt(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function wt(t){if(!Jt(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!Jt(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Jt(t){return Object.prototype.toString.call(t)==="[object Object]"}function nr(t){return new Promise(e=>{je.setTimeout(e,t)})}function Nt(t,e,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?ks(t,e):e}function ar(t,e,r=0){const n=[...t,e];return r&&n.length>r?n.slice(1):n}function ir(t,e,r=0){const n=[e,...t];return r&&n.length>r?n.slice(0,-1):n}var $t=Symbol();function Ss(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===$t?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function Ps(t,e){return typeof t=="function"?t(...e):!!t}function or(t,e,r){let n=!1,a;return Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(a??(a=e()),n||(n=!0,a.aborted?r():a.addEventListener("abort",r,{once:!0})),a)}),t}var Ne,ue,Ie,ds,lr=(ds=class extends Ge{constructor(){super();N(this,Ne);N(this,ue);N(this,Ie);g(this,Ie,e=>{if(!Fe&&window.addEventListener){const r=()=>e();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){i(this,ue)||this.setEventListener(i(this,Ie))}onUnsubscribe(){var e;this.hasListeners()||((e=i(this,ue))==null||e.call(this),g(this,ue,void 0))}setEventListener(e){var r;g(this,Ie,e),(r=i(this,ue))==null||r.call(this),g(this,ue,e(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(e){i(this,Ne)!==e&&(g(this,Ne,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(r=>{r(e)})}isFocused(){var e;return typeof i(this,Ne)=="boolean"?i(this,Ne):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Ne=new WeakMap,ue=new WeakMap,Ie=new WeakMap,ds),_t=new lr;function Ct(){let t,e;const r=new Promise((a,o)=>{t=a,e=o});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),t(a)},r.reject=a=>{n({status:"rejected",reason:a}),e(a)},r}var cr=tr;function ur(){let t=[],e=0,r=c=>{c()},n=c=>{c()},a=cr;const o=c=>{e?t.push(c):a(()=>{r(c)})},l=()=>{const c=t;t=[],c.length&&a(()=>{n(()=>{c.forEach(h=>{r(h)})})})};return{batch:c=>{let h;e++;try{h=c()}finally{e--,e||l()}return h},batchCalls:c=>(...h)=>{o(()=>{c(...h)})},schedule:o,setNotifyFunction:c=>{r=c},setBatchNotifyFunction:c=>{n=c},setScheduler:c=>{a=c}}}var T=ur(),De,de,$e,hs,dr=(hs=class extends Ge{constructor(){super();N(this,De,!0);N(this,de);N(this,$e);g(this,$e,e=>{if(!Fe&&window.addEventListener){const r=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){i(this,de)||this.setEventListener(i(this,$e))}onUnsubscribe(){var e;this.hasListeners()||((e=i(this,de))==null||e.call(this),g(this,de,void 0))}setEventListener(e){var r;g(this,$e,e),(r=i(this,de))==null||r.call(this),g(this,de,e(this.setOnline.bind(this)))}setOnline(e){i(this,De)!==e&&(g(this,De,e),this.listeners.forEach(n=>{n(e)}))}isOnline(){return i(this,De)}},De=new WeakMap,de=new WeakMap,$e=new WeakMap,hs),pt=new dr;function hr(t){return Math.min(1e3*2**t,3e4)}function Ms(t){return(t??"online")==="online"?pt.isOnline():!0}var kt=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function Ls(t){let e=!1,r=0,n;const a=Ct(),o=()=>a.status!=="pending",l=m=>{var j;if(!o()){const b=new kt(m);y(b),(j=t.onCancel)==null||j.call(t,b)}},c=()=>{e=!0},h=()=>{e=!1},x=()=>_t.isFocused()&&(t.networkMode==="always"||pt.isOnline())&&t.canRun(),v=()=>Ms(t.networkMode)&&t.canRun(),u=m=>{o()||(n==null||n(),a.resolve(m))},y=m=>{o()||(n==null||n(),a.reject(m))},p=()=>new Promise(m=>{var j;n=b=>{(o()||x())&&m(b)},(j=t.onPause)==null||j.call(t)}).then(()=>{var m;n=void 0,o()||(m=t.onContinue)==null||m.call(t)}),d=()=>{if(o())return;let m;const j=r===0?t.initialPromise:void 0;try{m=j??t.fn()}catch(b){m=Promise.reject(b)}Promise.resolve(m).then(u).catch(b=>{var E;if(o())return;const C=t.retry??(Fe?0:3),k=t.retryDelay??hr,w=typeof k=="function"?k(r,b):k,F=C===!0||typeof C=="number"&&r<C||typeof C=="function"&&C(r,b);if(e||!F){y(b);return}r++,(E=t.onFail)==null||E.call(t,r,b),nr(w).then(()=>x()?void 0:p()).then(()=>{e?y(b):d()})})};return{promise:a,status:()=>a.status,cancel:l,continue:()=>(n==null||n(),a),cancelRetry:c,continueRetry:h,canStart:v,start:()=>(v()?d():p().then(d),a)}}var Ce,ms,Rs=(ms=class{constructor(){N(this,Ce)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),jt(this.gcTime)&&g(this,Ce,je.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Fe?1/0:5*60*1e3))}clearGcTimeout(){i(this,Ce)&&(je.clearTimeout(i(this,Ce)),g(this,Ce,void 0))}},Ce=new WeakMap,ms),ke,_e,B,Se,q,tt,Pe,z,te,xs,mr=(xs=class extends Rs{constructor(e){super();N(this,z);N(this,ke);N(this,_e);N(this,B);N(this,Se);N(this,q);N(this,tt);N(this,Pe);g(this,Pe,!1),g(this,tt,e.defaultOptions),this.setOptions(e.options),this.observers=[],g(this,Se,e.client),g(this,B,i(this,Se).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,g(this,ke,Xt(this.options)),this.state=e.state??i(this,ke),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=i(this,q))==null?void 0:e.promise}setOptions(e){if(this.options={...i(this,tt),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=Xt(this.options);r.data!==void 0&&(this.setState(Yt(r.data,r.dataUpdatedAt)),g(this,ke,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&i(this,B).remove(this)}setData(e,r){const n=Nt(this.state.data,e,this.options);return S(this,z,te).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(e,r){S(this,z,te).call(this,{type:"setState",state:e,setStateOptions:r})}cancel(e){var n,a;const r=(n=i(this,q))==null?void 0:n.promise;return(a=i(this,q))==null||a.cancel(e),r?r.then(_).catch(_):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(i(this,ke))}isActive(){return this.observers.some(e=>H(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===$t||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>ge(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!Cs(this.state.dataUpdatedAt,e)}onFocus(){var r;const e=this.observers.find(n=>n.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(r=i(this,q))==null||r.continue()}onOnline(){var r;const e=this.observers.find(n=>n.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(r=i(this,q))==null||r.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),i(this,B).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(r=>r!==e),this.observers.length||(i(this,q)&&(i(this,Pe)?i(this,q).cancel({revert:!0}):i(this,q).cancelRetry()),this.scheduleGc()),i(this,B).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||S(this,z,te).call(this,{type:"invalidate"})}async fetch(e,r){var h,x,v,u,y,p,d,m,j,b,C,k;if(this.state.fetchStatus!=="idle"&&((h=i(this,q))==null?void 0:h.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(i(this,q))return i(this,q).continueRetry(),i(this,q).promise}if(e&&this.setOptions(e),!this.options.queryFn){const w=this.observers.find(F=>F.options.queryFn);w&&this.setOptions(w.options)}const n=new AbortController,a=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(g(this,Pe,!0),n.signal)})},o=()=>{const w=Ss(this.options,r),E=(()=>{const W={client:i(this,Se),queryKey:this.queryKey,meta:this.meta};return a(W),W})();return g(this,Pe,!1),this.options.persister?this.options.persister(w,E,this):w(E)},c=(()=>{const w={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:i(this,Se),state:this.state,fetchFn:o};return a(w),w})();(x=this.options.behavior)==null||x.onFetch(c,this),g(this,_e,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((v=c.fetchOptions)==null?void 0:v.meta))&&S(this,z,te).call(this,{type:"fetch",meta:(u=c.fetchOptions)==null?void 0:u.meta}),g(this,q,Ls({initialPromise:r==null?void 0:r.initialPromise,fn:c.fetchFn,onCancel:w=>{w instanceof kt&&w.revert&&this.setState({...i(this,_e),fetchStatus:"idle"}),n.abort()},onFail:(w,F)=>{S(this,z,te).call(this,{type:"failed",failureCount:w,error:F})},onPause:()=>{S(this,z,te).call(this,{type:"pause"})},onContinue:()=>{S(this,z,te).call(this,{type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0}));try{const w=await i(this,q).start();if(w===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(w),(p=(y=i(this,B).config).onSuccess)==null||p.call(y,w,this),(m=(d=i(this,B).config).onSettled)==null||m.call(d,w,this.state.error,this),w}catch(w){if(w instanceof kt){if(w.silent)return i(this,q).promise;if(w.revert){if(this.state.data===void 0)throw w;return this.state.data}}throw S(this,z,te).call(this,{type:"error",error:w}),(b=(j=i(this,B).config).onError)==null||b.call(j,w,this),(k=(C=i(this,B).config).onSettled)==null||k.call(C,this.state.data,w,this),w}finally{this.scheduleGc()}}},ke=new WeakMap,_e=new WeakMap,B=new WeakMap,Se=new WeakMap,q=new WeakMap,tt=new WeakMap,Pe=new WeakMap,z=new WeakSet,te=function(e){const r=n=>{switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...Es(n.data,this.options),fetchMeta:e.meta??null};case"success":const a={...n,...Yt(e.data,e.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return g(this,_e,e.manual?a:void 0),a;case"error":const o=e.error;return{...n,error:o,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}};this.state=r(this.state),T.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),i(this,B).notify({query:this,type:"updated",action:e})})},xs);function Es(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Ms(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Yt(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Xt(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,r=e!==void 0,n=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var U,P,st,D,Me,Ue,se,he,rt,Qe,Be,Le,Re,me,He,L,Ye,St,Pt,Mt,Lt,Rt,Et,Ot,Os,ps,xr=(ps=class extends Ge{constructor(e,r){super();N(this,L);N(this,U);N(this,P);N(this,st);N(this,D);N(this,Me);N(this,Ue);N(this,se);N(this,he);N(this,rt);N(this,Qe);N(this,Be);N(this,Le);N(this,Re);N(this,me);N(this,He,new Set);this.options=r,g(this,U,e),g(this,he,null),g(this,se,Ct()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(i(this,P).addObserver(this),Zt(i(this,P),this.options)?S(this,L,Ye).call(this):this.updateResult(),S(this,L,Lt).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Ft(i(this,P),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Ft(i(this,P),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,S(this,L,Rt).call(this),S(this,L,Et).call(this),i(this,P).removeObserver(this)}setOptions(e){const r=this.options,n=i(this,P);if(this.options=i(this,U).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof H(this.options.enabled,i(this,P))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");S(this,L,Ot).call(this),i(this,P).setOptions(this.options),r._defaulted&&!xt(this.options,r)&&i(this,U).getQueryCache().notify({type:"observerOptionsUpdated",query:i(this,P),observer:this});const a=this.hasListeners();a&&es(i(this,P),n,this.options,r)&&S(this,L,Ye).call(this),this.updateResult(),a&&(i(this,P)!==n||H(this.options.enabled,i(this,P))!==H(r.enabled,i(this,P))||ge(this.options.staleTime,i(this,P))!==ge(r.staleTime,i(this,P)))&&S(this,L,St).call(this);const o=S(this,L,Pt).call(this);a&&(i(this,P)!==n||H(this.options.enabled,i(this,P))!==H(r.enabled,i(this,P))||o!==i(this,me))&&S(this,L,Mt).call(this,o)}getOptimisticResult(e){const r=i(this,U).getQueryCache().build(i(this,U),e),n=this.createResult(r,e);return fr(this,n)&&(g(this,D,n),g(this,Ue,this.options),g(this,Me,i(this,P).state)),n}getCurrentResult(){return i(this,D)}trackResult(e,r){return new Proxy(e,{get:(n,a)=>(this.trackProp(a),r==null||r(a),a==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&i(this,se).status==="pending"&&i(this,se).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,a))})}trackProp(e){i(this,He).add(e)}getCurrentQuery(){return i(this,P)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const r=i(this,U).defaultQueryOptions(e),n=i(this,U).getQueryCache().build(i(this,U),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(e){return S(this,L,Ye).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),i(this,D)))}createResult(e,r){var oe;const n=i(this,P),a=this.options,o=i(this,D),l=i(this,Me),c=i(this,Ue),x=e!==n?e.state:i(this,st),{state:v}=e;let u={...v},y=!1,p;if(r._optimisticResults){const M=this.hasListeners(),A=!M&&Zt(e,r),Te=M&&es(e,n,r,a);(A||Te)&&(u={...u,...Es(v.data,e.options)}),r._optimisticResults==="isRestoring"&&(u.fetchStatus="idle")}let{error:d,errorUpdatedAt:m,status:j}=u;p=u.data;let b=!1;if(r.placeholderData!==void 0&&p===void 0&&j==="pending"){let M;o!=null&&o.isPlaceholderData&&r.placeholderData===(c==null?void 0:c.placeholderData)?(M=o.data,b=!0):M=typeof r.placeholderData=="function"?r.placeholderData((oe=i(this,Be))==null?void 0:oe.state.data,i(this,Be)):r.placeholderData,M!==void 0&&(j="success",p=Nt(o==null?void 0:o.data,M,r),y=!0)}if(r.select&&p!==void 0&&!b)if(o&&p===(l==null?void 0:l.data)&&r.select===i(this,rt))p=i(this,Qe);else try{g(this,rt,r.select),p=r.select(p),p=Nt(o==null?void 0:o.data,p,r),g(this,Qe,p),g(this,he,null)}catch(M){g(this,he,M)}i(this,he)&&(d=i(this,he),p=i(this,Qe),m=Date.now(),j="error");const C=u.fetchStatus==="fetching",k=j==="pending",w=j==="error",F=k&&C,E=p!==void 0,I={status:j,fetchStatus:u.fetchStatus,isPending:k,isSuccess:j==="success",isError:w,isInitialLoading:F,isLoading:F,data:p,dataUpdatedAt:u.dataUpdatedAt,error:d,errorUpdatedAt:m,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>x.dataUpdateCount||u.errorUpdateCount>x.errorUpdateCount,isFetching:C,isRefetching:C&&!k,isLoadingError:w&&!E,isPaused:u.fetchStatus==="paused",isPlaceholderData:y,isRefetchError:w&&E,isStale:Ut(e,r),refetch:this.refetch,promise:i(this,se),isEnabled:H(r.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const M=lt=>{I.status==="error"?lt.reject(I.error):I.data!==void 0&&lt.resolve(I.data)},A=()=>{const lt=g(this,se,I.promise=Ct());M(lt)},Te=i(this,se);switch(Te.status){case"pending":e.queryHash===n.queryHash&&M(Te);break;case"fulfilled":(I.status==="error"||I.data!==Te.value)&&A();break;case"rejected":(I.status!=="error"||I.error!==Te.reason)&&A();break}}return I}updateResult(){const e=i(this,D),r=this.createResult(i(this,P),this.options);if(g(this,Me,i(this,P).state),g(this,Ue,this.options),i(this,Me).data!==void 0&&g(this,Be,i(this,P)),xt(r,e))return;g(this,D,r);const n=()=>{if(!e)return!0;const{notifyOnChangeProps:a}=this.options,o=typeof a=="function"?a():a;if(o==="all"||!o&&!i(this,He).size)return!0;const l=new Set(o??i(this,He));return this.options.throwOnError&&l.add("error"),Object.keys(i(this,D)).some(c=>{const h=c;return i(this,D)[h]!==e[h]&&l.has(h)})};S(this,L,Os).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&S(this,L,Lt).call(this)}},U=new WeakMap,P=new WeakMap,st=new WeakMap,D=new WeakMap,Me=new WeakMap,Ue=new WeakMap,se=new WeakMap,he=new WeakMap,rt=new WeakMap,Qe=new WeakMap,Be=new WeakMap,Le=new WeakMap,Re=new WeakMap,me=new WeakMap,He=new WeakMap,L=new WeakSet,Ye=function(e){S(this,L,Ot).call(this);let r=i(this,P).fetch(this.options,e);return e!=null&&e.throwOnError||(r=r.catch(_)),r},St=function(){S(this,L,Rt).call(this);const e=ge(this.options.staleTime,i(this,P));if(Fe||i(this,D).isStale||!jt(e))return;const n=Cs(i(this,D).dataUpdatedAt,e)+1;g(this,Le,je.setTimeout(()=>{i(this,D).isStale||this.updateResult()},n))},Pt=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(i(this,P)):this.options.refetchInterval)??!1},Mt=function(e){S(this,L,Et).call(this),g(this,me,e),!(Fe||H(this.options.enabled,i(this,P))===!1||!jt(i(this,me))||i(this,me)===0)&&g(this,Re,je.setInterval(()=>{(this.options.refetchIntervalInBackground||_t.isFocused())&&S(this,L,Ye).call(this)},i(this,me)))},Lt=function(){S(this,L,St).call(this),S(this,L,Mt).call(this,S(this,L,Pt).call(this))},Rt=function(){i(this,Le)&&(je.clearTimeout(i(this,Le)),g(this,Le,void 0))},Et=function(){i(this,Re)&&(je.clearInterval(i(this,Re)),g(this,Re,void 0))},Ot=function(){const e=i(this,U).getQueryCache().build(i(this,U),this.options);if(e===i(this,P))return;const r=i(this,P);g(this,P,e),g(this,st,e.state),this.hasListeners()&&(r==null||r.removeObserver(this),e.addObserver(this))},Os=function(e){T.batch(()=>{e.listeners&&this.listeners.forEach(r=>{r(i(this,D))}),i(this,U).getQueryCache().notify({query:i(this,P),type:"observerResultsUpdated"})})},ps);function pr(t,e){return H(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Zt(t,e){return pr(t,e)||t.state.data!==void 0&&Ft(t,e,e.refetchOnMount)}function Ft(t,e,r){if(H(e.enabled,t)!==!1&&ge(e.staleTime,t)!=="static"){const n=typeof r=="function"?r(t):r;return n==="always"||n!==!1&&Ut(t,e)}return!1}function es(t,e,r,n){return(t!==e||H(n.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&Ut(t,r)}function Ut(t,e){return H(e.enabled,t)!==!1&&t.isStaleByTime(ge(e.staleTime,t))}function fr(t,e){return!xt(t.getCurrentResult(),e)}function ts(t){return{onFetch:(e,r)=>{var v,u,y,p,d;const n=e.options,a=(y=(u=(v=e.fetchOptions)==null?void 0:v.meta)==null?void 0:u.fetchMore)==null?void 0:y.direction,o=((p=e.state.data)==null?void 0:p.pages)||[],l=((d=e.state.data)==null?void 0:d.pageParams)||[];let c={pages:[],pageParams:[]},h=0;const x=async()=>{let m=!1;const j=k=>{or(k,()=>e.signal,()=>m=!0)},b=Ss(e.options,e.fetchOptions),C=async(k,w,F)=>{if(m)return Promise.reject();if(w==null&&k.pages.length)return Promise.resolve(k);const W=(()=>{const A={client:e.client,queryKey:e.queryKey,pageParam:w,direction:F?"backward":"forward",meta:e.options.meta};return j(A),A})(),I=await b(W),{maxPages:oe}=e.options,M=F?ir:ar;return{pages:M(k.pages,I,oe),pageParams:M(k.pageParams,w,oe)}};if(a&&o.length){const k=a==="backward",w=k?yr:ss,F={pages:o,pageParams:l},E=w(n,F);c=await C(F,E,k)}else{const k=t??o.length;do{const w=h===0?l[0]??n.initialPageParam:ss(n,c);if(h>0&&w==null)break;c=await C(c,w),h++}while(h<k)}return c};e.options.persister?e.fetchFn=()=>{var m,j;return(j=(m=e.options).persister)==null?void 0:j.call(m,x,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r)}:e.fetchFn=x}}}function ss(t,{pages:e,pageParams:r}){const n=e.length-1;return e.length>0?t.getNextPageParam(e[n],e,r[n],r):void 0}function yr(t,{pages:e,pageParams:r}){var n;return e.length>0?(n=t.getPreviousPageParam)==null?void 0:n.call(t,e[0],e,r[0],r):void 0}var nt,J,$,Ee,Y,le,fs,gr=(fs=class extends Rs{constructor(e){super();N(this,Y);N(this,nt);N(this,J);N(this,$);N(this,Ee);g(this,nt,e.client),this.mutationId=e.mutationId,g(this,$,e.mutationCache),g(this,J,[]),this.state=e.state||Fs(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){i(this,J).includes(e)||(i(this,J).push(e),this.clearGcTimeout(),i(this,$).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){g(this,J,i(this,J).filter(r=>r!==e)),this.scheduleGc(),i(this,$).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){i(this,J).length||(this.state.status==="pending"?this.scheduleGc():i(this,$).remove(this))}continue(){var e;return((e=i(this,Ee))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var l,c,h,x,v,u,y,p,d,m,j,b,C,k,w,F,E,W,I,oe;const r=()=>{S(this,Y,le).call(this,{type:"continue"})},n={client:i(this,nt),meta:this.options.meta,mutationKey:this.options.mutationKey};g(this,Ee,Ls({fn:()=>this.options.mutationFn?this.options.mutationFn(e,n):Promise.reject(new Error("No mutationFn found")),onFail:(M,A)=>{S(this,Y,le).call(this,{type:"failed",failureCount:M,error:A})},onPause:()=>{S(this,Y,le).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>i(this,$).canRun(this)}));const a=this.state.status==="pending",o=!i(this,Ee).canStart();try{if(a)r();else{S(this,Y,le).call(this,{type:"pending",variables:e,isPaused:o}),await((c=(l=i(this,$).config).onMutate)==null?void 0:c.call(l,e,this,n));const A=await((x=(h=this.options).onMutate)==null?void 0:x.call(h,e,n));A!==this.state.context&&S(this,Y,le).call(this,{type:"pending",context:A,variables:e,isPaused:o})}const M=await i(this,Ee).start();return await((u=(v=i(this,$).config).onSuccess)==null?void 0:u.call(v,M,e,this.state.context,this,n)),await((p=(y=this.options).onSuccess)==null?void 0:p.call(y,M,e,this.state.context,n)),await((m=(d=i(this,$).config).onSettled)==null?void 0:m.call(d,M,null,this.state.variables,this.state.context,this,n)),await((b=(j=this.options).onSettled)==null?void 0:b.call(j,M,null,e,this.state.context,n)),S(this,Y,le).call(this,{type:"success",data:M}),M}catch(M){try{await((k=(C=i(this,$).config).onError)==null?void 0:k.call(C,M,e,this.state.context,this,n))}catch(A){Promise.reject(A)}try{await((F=(w=this.options).onError)==null?void 0:F.call(w,M,e,this.state.context,n))}catch(A){Promise.reject(A)}try{await((W=(E=i(this,$).config).onSettled)==null?void 0:W.call(E,void 0,M,this.state.variables,this.state.context,this,n))}catch(A){Promise.reject(A)}try{await((oe=(I=this.options).onSettled)==null?void 0:oe.call(I,void 0,M,e,this.state.context,n))}catch(A){Promise.reject(A)}throw S(this,Y,le).call(this,{type:"error",error:M}),M}finally{i(this,$).runNext(this)}}},nt=new WeakMap,J=new WeakMap,$=new WeakMap,Ee=new WeakMap,Y=new WeakSet,le=function(e){const r=n=>{switch(e.type){case"failed":return{...n,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=r(this.state),T.batch(()=>{i(this,J).forEach(n=>{n.onMutationUpdate(e)}),i(this,$).notify({mutation:this,type:"updated",action:e})})},fs);function Fs(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var re,V,at,ys,br=(ys=class extends Ge{constructor(e={}){super();N(this,re);N(this,V);N(this,at);this.config=e,g(this,re,new Set),g(this,V,new Map),g(this,at,0)}build(e,r,n){const a=new gr({client:e,mutationCache:this,mutationId:++ct(this,at)._,options:e.defaultMutationOptions(r),state:n});return this.add(a),a}add(e){i(this,re).add(e);const r=ut(e);if(typeof r=="string"){const n=i(this,V).get(r);n?n.push(e):i(this,V).set(r,[e])}this.notify({type:"added",mutation:e})}remove(e){if(i(this,re).delete(e)){const r=ut(e);if(typeof r=="string"){const n=i(this,V).get(r);if(n)if(n.length>1){const a=n.indexOf(e);a!==-1&&n.splice(a,1)}else n[0]===e&&i(this,V).delete(r)}}this.notify({type:"removed",mutation:e})}canRun(e){const r=ut(e);if(typeof r=="string"){const n=i(this,V).get(r),a=n==null?void 0:n.find(o=>o.state.status==="pending");return!a||a===e}else return!0}runNext(e){var n;const r=ut(e);if(typeof r=="string"){const a=(n=i(this,V).get(r))==null?void 0:n.find(o=>o!==e&&o.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){T.batch(()=>{i(this,re).forEach(e=>{this.notify({type:"removed",mutation:e})}),i(this,re).clear(),i(this,V).clear()})}getAll(){return Array.from(i(this,re))}find(e){const r={exact:!0,...e};return this.getAll().find(n=>Vt(r,n))}findAll(e={}){return this.getAll().filter(r=>Vt(e,r))}notify(e){T.batch(()=>{this.listeners.forEach(r=>{r(e)})})}resumePausedMutations(){const e=this.getAll().filter(r=>r.state.isPaused);return T.batch(()=>Promise.all(e.map(r=>r.continue().catch(_))))}},re=new WeakMap,V=new WeakMap,at=new WeakMap,ys);function ut(t){var e;return(e=t.options.scope)==null?void 0:e.id}var ne,xe,Q,ae,ie,mt,At,gs,vr=(gs=class extends Ge{constructor(r,n){super();N(this,ie);N(this,ne);N(this,xe);N(this,Q);N(this,ae);g(this,ne,r),this.setOptions(n),this.bindMethods(),S(this,ie,mt).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var a;const n=this.options;this.options=i(this,ne).defaultMutationOptions(r),xt(this.options,n)||i(this,ne).getMutationCache().notify({type:"observerOptionsUpdated",mutation:i(this,Q),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&Ae(n.mutationKey)!==Ae(this.options.mutationKey)?this.reset():((a=i(this,Q))==null?void 0:a.state.status)==="pending"&&i(this,Q).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=i(this,Q))==null||r.removeObserver(this)}onMutationUpdate(r){S(this,ie,mt).call(this),S(this,ie,At).call(this,r)}getCurrentResult(){return i(this,xe)}reset(){var r;(r=i(this,Q))==null||r.removeObserver(this),g(this,Q,void 0),S(this,ie,mt).call(this),S(this,ie,At).call(this)}mutate(r,n){var a;return g(this,ae,n),(a=i(this,Q))==null||a.removeObserver(this),g(this,Q,i(this,ne).getMutationCache().build(i(this,ne),this.options)),i(this,Q).addObserver(this),i(this,Q).execute(r)}},ne=new WeakMap,xe=new WeakMap,Q=new WeakMap,ae=new WeakMap,ie=new WeakSet,mt=function(){var n;const r=((n=i(this,Q))==null?void 0:n.state)??Fs();g(this,xe,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},At=function(r){T.batch(()=>{var n,a,o,l,c,h,x,v;if(i(this,ae)&&this.hasListeners()){const u=i(this,xe).variables,y=i(this,xe).context,p={client:i(this,ne),meta:this.options.meta,mutationKey:this.options.mutationKey};if((r==null?void 0:r.type)==="success"){try{(a=(n=i(this,ae)).onSuccess)==null||a.call(n,r.data,u,y,p)}catch(d){Promise.reject(d)}try{(l=(o=i(this,ae)).onSettled)==null||l.call(o,r.data,null,u,y,p)}catch(d){Promise.reject(d)}}else if((r==null?void 0:r.type)==="error"){try{(h=(c=i(this,ae)).onError)==null||h.call(c,r.error,u,y,p)}catch(d){Promise.reject(d)}try{(v=(x=i(this,ae)).onSettled)==null||v.call(x,void 0,r.error,u,y,p)}catch(d){Promise.reject(d)}}}this.listeners.forEach(u=>{u(i(this,xe))})})},gs),X,bs,jr=(bs=class extends Ge{constructor(e={}){super();N(this,X);this.config=e,g(this,X,new Map)}build(e,r,n){const a=r.queryKey,o=r.queryHash??Dt(a,r);let l=this.get(o);return l||(l=new mr({client:e,queryKey:a,queryHash:o,options:e.defaultQueryOptions(r),state:n,defaultOptions:e.getQueryDefaults(a)}),this.add(l)),l}add(e){i(this,X).has(e.queryHash)||(i(this,X).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const r=i(this,X).get(e.queryHash);r&&(e.destroy(),r===e&&i(this,X).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){T.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return i(this,X).get(e)}getAll(){return[...i(this,X).values()]}find(e){const r={exact:!0,...e};return this.getAll().find(n=>zt(r,n))}findAll(e={}){const r=this.getAll();return Object.keys(e).length>0?r.filter(n=>zt(e,n)):r}notify(e){T.batch(()=>{this.listeners.forEach(r=>{r(e)})})}onFocus(){T.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){T.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},X=new WeakMap,bs),O,pe,fe,Ke,We,ye,ze,Ve,vs,wr=(vs=class{constructor(t={}){N(this,O);N(this,pe);N(this,fe);N(this,Ke);N(this,We);N(this,ye);N(this,ze);N(this,Ve);g(this,O,t.queryCache||new jr),g(this,pe,t.mutationCache||new br),g(this,fe,t.defaultOptions||{}),g(this,Ke,new Map),g(this,We,new Map),g(this,ye,0)}mount(){ct(this,ye)._++,i(this,ye)===1&&(g(this,ze,_t.subscribe(async t=>{t&&(await this.resumePausedMutations(),i(this,O).onFocus())})),g(this,Ve,pt.subscribe(async t=>{t&&(await this.resumePausedMutations(),i(this,O).onOnline())})))}unmount(){var t,e;ct(this,ye)._--,i(this,ye)===0&&((t=i(this,ze))==null||t.call(this),g(this,ze,void 0),(e=i(this,Ve))==null||e.call(this),g(this,Ve,void 0))}isFetching(t){return i(this,O).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return i(this,pe).findAll({...t,status:"pending"}).length}getQueryData(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=i(this,O).get(e.queryHash))==null?void 0:r.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),r=i(this,O).build(this,e),n=r.state.data;return n===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(ge(e.staleTime,r))&&this.prefetchQuery(e),Promise.resolve(n))}getQueriesData(t){return i(this,O).findAll(t).map(({queryKey:e,state:r})=>{const n=r.data;return[e,n]})}setQueryData(t,e,r){const n=this.defaultQueryOptions({queryKey:t}),a=i(this,O).get(n.queryHash),o=a==null?void 0:a.state.data,l=sr(e,o);if(l!==void 0)return i(this,O).build(this,n).setData(l,{...r,manual:!0})}setQueriesData(t,e,r){return T.batch(()=>i(this,O).findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,e,r)]))}getQueryState(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=i(this,O).get(e.queryHash))==null?void 0:r.state}removeQueries(t){const e=i(this,O);T.batch(()=>{e.findAll(t).forEach(r=>{e.remove(r)})})}resetQueries(t,e){const r=i(this,O);return T.batch(()=>(r.findAll(t).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const r={revert:!0,...e},n=T.batch(()=>i(this,O).findAll(t).map(a=>a.cancel(r)));return Promise.all(n).then(_).catch(_)}invalidateQueries(t,e={}){return T.batch(()=>(i(this,O).findAll(t).forEach(r=>{r.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const r={...e,cancelRefetch:e.cancelRefetch??!0},n=T.batch(()=>i(this,O).findAll(t).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let o=a.fetch(void 0,r);return r.throwOnError||(o=o.catch(_)),a.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(n).then(_)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const r=i(this,O).build(this,e);return r.isStaleByTime(ge(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(_).catch(_)}fetchInfiniteQuery(t){return t.behavior=ts(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(_).catch(_)}ensureInfiniteQueryData(t){return t.behavior=ts(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return pt.isOnline()?i(this,pe).resumePausedMutations():Promise.resolve()}getQueryCache(){return i(this,O)}getMutationCache(){return i(this,pe)}getDefaultOptions(){return i(this,fe)}setDefaultOptions(t){g(this,fe,t)}setQueryDefaults(t,e){i(this,Ke).set(Ae(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...i(this,Ke).values()],r={};return e.forEach(n=>{Ze(t,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(t,e){i(this,We).set(Ae(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...i(this,We).values()],r={};return e.forEach(n=>{Ze(t,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const e={...i(this,fe).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Dt(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===$t&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...i(this,fe).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){i(this,O).clear(),i(this,pe).clear()}},O=new WeakMap,pe=new WeakMap,fe=new WeakMap,Ke=new WeakMap,We=new WeakMap,ye=new WeakMap,ze=new WeakMap,Ve=new WeakMap,vs),As=f.createContext(void 0),it=t=>{const e=f.useContext(As);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},Nr=({client:t,children:e})=>(f.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),s.jsx(As.Provider,{value:t,children:e})),Ts=f.createContext(!1),Cr=()=>f.useContext(Ts);Ts.Provider;function kr(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var Sr=f.createContext(kr()),Pr=()=>f.useContext(Sr),Mr=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},Lr=t=>{f.useEffect(()=>{t.clearReset()},[t])},Rr=({result:t,errorResetBoundary:e,throwOnError:r,query:n,suspense:a})=>t.isError&&!e.isReset()&&!t.isFetching&&n&&(a&&t.data===void 0||Ps(r,[t.error,n])),Er=t=>{if(t.suspense){const r=a=>a==="static"?a:Math.max(a??1e3,1e3),n=t.staleTime;t.staleTime=typeof n=="function"?(...a)=>r(n(...a)):r(n),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},Or=(t,e)=>t.isLoading&&t.isFetching&&!e,Fr=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,rs=(t,e,r)=>e.fetchOptimistic(t).catch(()=>{r.clearReset()});function Ar(t,e,r){var u,y,p,d,m;const n=Cr(),a=Pr(),o=it(),l=o.defaultQueryOptions(t);(y=(u=o.getDefaultOptions().queries)==null?void 0:u._experimental_beforeQuery)==null||y.call(u,l),l._optimisticResults=n?"isRestoring":"optimistic",Er(l),Mr(l,a),Lr(a);const c=!o.getQueryCache().get(l.queryHash),[h]=f.useState(()=>new e(o,l)),x=h.getOptimisticResult(l),v=!n&&t.subscribed!==!1;if(f.useSyncExternalStore(f.useCallback(j=>{const b=v?h.subscribe(T.batchCalls(j)):_;return h.updateResult(),b},[h,v]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),f.useEffect(()=>{h.setOptions(l)},[l,h]),Fr(l,x))throw rs(l,h,a);if(Rr({result:x,errorResetBoundary:a,throwOnError:l.throwOnError,query:o.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw x.error;if((d=(p=o.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||d.call(p,l,x),l.experimental_prefetchInRender&&!Fe&&Or(x,n)){const j=c?rs(l,h,a):(m=o.getQueryCache().get(l.queryHash))==null?void 0:m.promise;j==null||j.catch(_).finally(()=>{h.updateResult()})}return l.notifyOnChangeProps?x:h.trackResult(x)}function Z(t,e){return Ar(t,xr)}function et(t,e){const r=it(),[n]=f.useState(()=>new vr(r,t));f.useEffect(()=>{n.setOptions(t)},[n,t]);const a=f.useSyncExternalStore(f.useCallback(l=>n.subscribe(T.batchCalls(l)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),o=f.useCallback((l,c)=>{n.mutate(l,c).catch(_)},[n]);if(a.error&&Ps(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:o,mutateAsync:a.mutate}}const qs=f.createContext(null);function Tr({children:t}){const[e,r]=f.useState({type:"none"}),[n,a]=f.useState(!0),o=f.useRef(null),l=f.useCallback(()=>{o.current&&(clearTimeout(o.current),o.current=null)},[]),c=f.useCallback(d=>{l(),r({type:"module",module:d})},[l]),h=f.useCallback((d,m)=>{l(),r({type:"field",field:d,module:m})},[l]),x=f.useCallback((d,m)=>{l(),r({type:"action",action:d,module:m})},[l]),v=f.useCallback(()=>{l(),o.current=setTimeout(()=>{r({type:"none"})},300)},[l]),u=f.useCallback(()=>{a(d=>!d)},[]),y=f.useCallback(d=>{a(d)},[]),p=f.useMemo(()=>({focus:e,focusModule:c,focusField:h,focusAction:x,clearFocus:v,cancelClearFocus:l,isExpanded:n,toggleExpanded:u,setExpanded:y}),[e,c,h,x,v,l,n,u,y]);return s.jsx(qs.Provider,{value:p,children:t})}function ot(){const t=f.useContext(qs);if(!t)throw new Error("useDocumentation must be used within a DocumentationProvider");return t}function qr(t,e){const{focusField:r,clearFocus:n}=ot();return f.useMemo(()=>({onFocus:()=>r(t,e),onMouseEnter:()=>r(t,e),onBlur:n,onMouseLeave:n}),[t,e,r,n])}const Is=f.createContext(null);function Ir({children:t}){const[e,r]=f.useState(null),[n,a]=f.useState(!0),[o,l]=f.useState(!1),c=async()=>{try{if((await(await fetch("/mod/auth/setup-required",{credentials:"include"})).json()).setup_required){l(!0),r(null),a(!1);return}l(!1);const d=await fetch("/mod/auth/me",{credentials:"include"});if(d.ok){const m=await d.json();r(m.user)}else r(null)}catch{r(null)}finally{a(!1)}};f.useEffect(()=>{c()},[]);const h=async(y,p)=>{const d=await fetch("/mod/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:y,password:p})}),m=await d.json();if(!d.ok)throw new Error(m.error||"Login failed");r(m.user)},x=async(y,p,d)=>{const m=await fetch("/mod/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:y,password:p,name:d})}),j=await m.json();if(!m.ok)throw new Error(j.error||"Registration failed");r(j.user)},v=async(y,p,d)=>{const m=await fetch("/mod/auth/setup",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:y,password:p,name:d})}),j=await m.json();if(!m.ok)throw new Error(j.error||"Setup failed");l(!1),r(j.user)},u=async()=>{await fetch("/mod/auth/logout",{method:"POST",credentials:"include"}),r(null)};return s.jsx(Is.Provider,{value:{user:e,isLoading:n,isAuthenticated:!!e,setupRequired:o,login:h,register:x,setup:v,logout:u,checkAuth:c},children:t})}function Je(){const t=f.useContext(Is);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t}const be="/mod",ns=new Map,Dr=5*60*1e3,ve={credentials:"include"};async function Qt(){const t=await fetch(`${be}/_schema`,ve);if(!t.ok)throw new Error(`Failed to fetch modules: ${t.statusText}`);return((await t.json()).modules||[]).map(r=>({module:r.name,plural:r.plural,description:r.description||""}))}async function Ds(t){const e=ns.get(t);if(e&&Date.now()-e.timestamp<Dr)return e.data;const r=await fetch(`${be}/_schema/${t}`,ve);if(!r.ok)throw new Error(`Failed to fetch schema for ${t}: ${r.statusText}`);const n=await r.json();return ns.set(t,{data:n,timestamp:Date.now()}),n}async function Bt(t,e){const r=new URLSearchParams;e!=null&&e.limit&&r.set("limit",String(e.limit)),e!=null&&e.offset&&r.set("offset",String(e.offset));const n=`${be}/${t}${r.toString()?`?${r}`:""}`,a=await fetch(n,ve);if(!a.ok)throw new Error(`Failed to fetch ${t}: ${a.statusText}`);return a.json()}async function $r(t,e){const r=await fetch(`${be}/${t}/${encodeURIComponent(e)}`,ve);if(!r.ok)throw r.status===404?new Error(`Record not found: ${e}`):new Error(`Failed to fetch record: ${r.statusText}`);return r.json()}async function _r(t,e){const r=await fetch(`${be}/${t}`,{...ve,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok){const n=await r.json().catch(()=>({error:r.statusText}));throw new Error(n.error||"Failed to create record")}return r.json()}async function Ur(t,e,r){const n=await fetch(`${be}/${t}/${encodeURIComponent(e)}`,{...ve,method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){const a=await n.json().catch(()=>({error:n.statusText}));throw new Error(a.error||"Failed to update record")}return n.json()}async function Qr(t,e){const r=await fetch(`${be}/${t}/${encodeURIComponent(e)}`,{...ve,method:"DELETE"});if(!r.ok){const n=await r.json().catch(()=>({error:r.statusText}));throw new Error(n.error||"Failed to delete record")}}async function $s(t,e,r,n){const a=await fetch(`${be}/${t}/${encodeURIComponent(r)}/${e}`,{...ve,method:"POST",headers:{"Content-Type":"application/json"},body:n?JSON.stringify(n):void 0});if(!a.ok){const o=await a.json().catch(()=>({error:a.statusText}));throw new Error(o.error||`Failed to execute ${e}`)}return a.json()}function _s(t,e,r){const n="http://localhost:8080";let a=t.http.path.replace("{module}",e.plural).replace("{id}","<id>"),o=`curl -X ${t.http.method} "${n}${a}"`;return o+=` \\
  -H "Content-Type: application/json"`,t.auth&&t.auth!=="none"&&(o+=` \\
  -H "X-API-Key: <your-api-key>"`),["POST","PUT","PATCH"].includes(t.http.method)&&r&&(o+=` \\
  -d '${JSON.stringify(r,null,2)}'`),o}function we(t,e="create"){const r={};for(const n of t.fields)n.internal||n.computed||e==="update"&&n.immutable||(r[n.name]=Br(n));return r}function Br(t){var e;if(t.default!==void 0)return t.default;switch(t.type){case"string":case"text":return`sample_${t.name}`;case"int":return 100;case"float":return 99.99;case"bool":return!0;case"email":return"user@example.com";case"url":return"https://example.com";case"uuid":return"550e8400-e29b-41d4-a716-446655440000";case"datetime":return new Date().toISOString();case"date":return new Date().toISOString().split("T")[0];case"time":return"12:00:00";case"duration":return"1h30m";case"json":return{key:"value"};case"secret":return"********";case"enum":return((e=t.values)==null?void 0:e[0])??"option1";case"ref":return`${t.ref}_id_123`;case"bytes":return"<binary data>";default:return null}}function Hr(t){const e=[];for(const r of t.actions){const n=Kr(r,t);n&&e.push(n)}return e}function Kr(t,e){const r=t.type==="create"||t.type==="update"?we(e,t.type):void 0,n=t.http.path.replace("{module}",e.plural).replace("{id}","user_123");return{title:`${t.type.charAt(0).toUpperCase()+t.type.slice(1)} ${e.module}`,description:t.description,method:t.http.method,path:n,curl:_s(t,e,r),requestBody:r?JSON.stringify(r,null,2):void 0,responseBody:Wr(t,e)}}function Wr(t,e){switch(t.type){case"list":return JSON.stringify({module:e.module,count:2,data:[we(e),we(e)]},null,2);case"get":case"create":case"update":return JSON.stringify({module:e.module,data:we(e)},null,2);case"delete":return JSON.stringify({success:!0},null,2);default:return JSON.stringify({module:e.module,data:we(e)},null,2)}}function Us(t){var e;return t.type==="enum"&&((e=t.values)!=null&&e.length)?`enum(${t.values.join(" | ")})`:t.type==="ref"&&t.ref?`ref(${t.ref})`:t.type}function zr(t){switch(t.type){case"min":return`Minimum value: ${t.value}`;case"max":return`Maximum value: ${t.value}`;case"min_length":return`Minimum length: ${t.value} characters`;case"max_length":return`Maximum length: ${t.value} characters`;case"pattern":return`Must match pattern: ${t.value}`;case"ref_exists":return"Referenced record must exist";default:return`${t.type}: ${t.value}`}}function Vr(t){const e=[];if(t.required&&e.push("Required field"),t.unique&&e.push("Must be unique"),t.immutable&&e.push("Cannot be changed after creation"),t.constraints)for(const r of t.constraints)e.push(zr(r));switch(t.type){case"email":e.push("Must be a valid email address");break;case"url":e.push("Must be a valid URL");break;case"uuid":e.push("Must be a valid UUID");break}return e}const Gr=[{id:"spec",label:"Spec"},{id:"details",label:"Details"},{id:"api",label:"API"},{id:"examples",label:"Examples"}];function Jr(){const{focus:t,isExpanded:e,toggleExpanded:r,cancelClearFocus:n}=ot(),[a,o]=f.useState("spec");return e?s.jsxs("div",{className:"w-80 bg-white border-l border-gray-200 flex flex-col h-full",onMouseEnter:n,children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 bg-gray-50",children:[s.jsx("h2",{className:"text-sm font-semibold text-gray-700",children:"Documentation"}),s.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Hide Documentation",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"flex border-b border-gray-200",children:Gr.map(l=>s.jsx("button",{onClick:()=>o(l.id),className:`flex-1 px-3 py-2 text-xs font-medium transition-colors ${a===l.id?"text-primary-600 border-b-2 border-primary-600 bg-primary-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:l.label},l.id))}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[t.type==="none"&&s.jsx(Yr,{}),t.type==="module"&&t.module&&s.jsx(Xr,{module:t.module,tab:a}),t.type==="field"&&t.field&&t.module&&s.jsx(Zr,{field:t.field,module:t.module,tab:a}),t.type==="action"&&t.action&&t.module&&s.jsx(en,{action:t.action,module:t.module,tab:a})]})]}):s.jsx("button",{onClick:r,className:"fixed right-0 top-1/2 -translate-y-1/2 bg-primary-600 text-white p-2 rounded-l-lg shadow-lg hover:bg-primary-700 transition-colors",title:"Show Documentation",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})}function Yr(){return s.jsxs("div",{className:"text-center text-gray-500 py-8",children:[s.jsx("svg",{className:"w-12 h-12 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),s.jsx("p",{className:"text-sm",children:"Hover over or focus on a field to see its documentation."})]})}function Xr({module:t,tab:e}){const r=f.useMemo(()=>Hr(t),[t]);switch(e){case"spec":return s.jsxs("div",{className:"space-y-4",children:[s.jsxs(R,{title:"Module",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.module}),s.jsxs("p",{className:"text-xs text-gray-500",children:["Plural: ",t.plural]})]}),s.jsx(R,{title:"Fields",children:s.jsx("ul",{className:"space-y-1",children:t.fields.filter(n=>!n.internal).map(n=>s.jsxs("li",{className:"text-xs",children:[s.jsx("code",{className:"text-primary-600",children:n.name}),s.jsxs("span",{className:"text-gray-500",children:[" : ",Us(n)]}),n.required&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"})]},n.name))})}),s.jsx(R,{title:"Lookups",children:s.jsxs("p",{className:"text-xs text-gray-600",children:["Records can be looked up by: ",t.lookups.join(", ")]})})]});case"details":return s.jsxs("div",{className:"space-y-4",children:[s.jsx(R,{title:"Description",children:s.jsx("p",{className:"text-sm text-gray-700",children:t.description||"No description available."})}),s.jsx(R,{title:"Actions",children:s.jsx("ul",{className:"space-y-2",children:t.actions.map(n=>s.jsxs("li",{className:"text-xs",children:[s.jsx("span",{className:"font-medium text-gray-900",children:n.name}),s.jsx("p",{className:"text-gray-500",children:n.description})]},n.name))})})]});case"api":return s.jsx("div",{className:"space-y-4",children:s.jsx(R,{title:"Endpoints",children:t.actions.map(n=>s.jsxs("div",{className:"mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Qs,{method:n.http.method}),s.jsx("code",{className:"text-xs text-gray-700",children:n.http.path.replace("{module}",t.plural)})]}),s.jsx("p",{className:"text-xs text-gray-500",children:n.description})]},n.name))})});case"examples":return s.jsx("div",{className:"space-y-4",children:r.slice(0,3).map((n,a)=>s.jsx(R,{title:n.title,children:s.jsx(qe,{code:n.curl})},a))});default:return null}}function Zr({field:t,module:e,tab:r}){const n=f.useMemo(()=>Vr(t),[t]);switch(r){case"spec":return s.jsxs("div",{className:"space-y-4",children:[s.jsx(R,{title:"Field",children:s.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.name})}),s.jsx(R,{title:"Type",children:s.jsx("code",{className:"text-sm text-primary-600",children:Us(t)})}),t.values&&t.values.length>0&&s.jsx(R,{title:"Allowed Values",children:s.jsx("ul",{className:"space-y-1",children:t.values.map(a=>s.jsx("li",{className:"text-xs",children:s.jsx("code",{className:"bg-gray-100 px-1 rounded",children:a})},a))})}),s.jsx(R,{title:"Attributes",children:s.jsxs("ul",{className:"space-y-1 text-xs",children:[s.jsxs("li",{children:["Required: ",s.jsx("span",{className:t.required?"text-red-600":"text-gray-500",children:t.required?"Yes":"No"})]}),t.unique&&s.jsxs("li",{children:["Unique: ",s.jsx("span",{className:"text-amber-600",children:"Yes"})]}),t.immutable&&s.jsxs("li",{children:["Immutable: ",s.jsx("span",{className:"text-amber-600",children:"Yes"})]}),t.computed&&s.jsxs("li",{children:["Computed: ",s.jsx("span",{className:"text-blue-600",children:"Yes (auto-generated)"})]})]})})]});case"details":return s.jsxs("div",{className:"space-y-4",children:[s.jsx(R,{title:"Description",children:s.jsx("p",{className:"text-sm text-gray-700",children:t.description||"No description available."})}),n.length>0&&s.jsx(R,{title:"Validation Rules",children:s.jsx("ul",{className:"space-y-1",children:n.map((a,o)=>s.jsxs("li",{className:"text-xs text-gray-600 flex items-start gap-2",children:[s.jsx("span",{className:"text-primary-500 mt-0.5",children:"*"}),a]},o))})}),t.ref&&s.jsx(R,{title:"Reference",children:s.jsxs("p",{className:"text-xs text-gray-600",children:["References a record in the ",s.jsx("code",{className:"text-primary-600",children:t.ref})," module."]})})]});case"api":return s.jsxs("div",{className:"space-y-4",children:[s.jsx(R,{title:"JSON Path",children:s.jsxs("code",{className:"text-sm text-gray-700",children:["$.data.",t.name]})}),s.jsx(R,{title:"In Request Body",children:s.jsx(qe,{code:JSON.stringify({[t.name]:as(t)},null,2)})})]});case"examples":return s.jsxs("div",{className:"space-y-4",children:[s.jsx(R,{title:"Example Values",children:s.jsx(qe,{code:String(as(t))})}),t.type==="enum"&&t.values&&s.jsx(R,{title:"Valid Options",children:s.jsx("ul",{className:"space-y-1",children:t.values.map(a=>s.jsx("li",{className:"text-xs",children:s.jsx("code",{className:"bg-gray-100 px-2 py-0.5 rounded",children:a})},a))})})]});default:return null}}function as(t){var e;if(t.default!==void 0)return t.default;switch(t.type){case"string":return`sample_${t.name}`;case"int":return 100;case"float":return 99.99;case"bool":return!0;case"email":return"user@example.com";case"url":return"https://example.com";case"enum":return((e=t.values)==null?void 0:e[0])??"option1";case"ref":return`${t.ref}_id`;default:return null}}function en({action:t,module:e,tab:r}){const n=f.useMemo(()=>t.type==="create"||t.type==="update"?we(e,t.type):void 0,[t,e]),a=f.useMemo(()=>_s(t,e,n),[t,e,n]);switch(r){case"spec":return s.jsxs("div",{className:"space-y-4",children:[s.jsx(R,{title:"Action",children:s.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.name})}),s.jsx(R,{title:"Type",children:s.jsx("span",{className:"inline-block px-2 py-0.5 bg-primary-100 text-primary-700 text-xs rounded",children:t.type})}),s.jsx(R,{title:"HTTP",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Qs,{method:t.http.method}),s.jsx("code",{className:"text-xs text-gray-700",children:t.http.path.replace("{module}",e.plural)})]})}),t.auth&&t.auth!=="none"&&s.jsx(R,{title:"Authentication",children:s.jsxs("p",{className:"text-xs text-gray-600",children:["Requires: ",t.auth]})}),t.confirm&&s.jsx(R,{title:"Confirmation",children:s.jsx("p",{className:"text-xs text-amber-600",children:"This action requires confirmation"})})]});case"details":return s.jsxs("div",{className:"space-y-4",children:[s.jsx(R,{title:"Description",children:s.jsx("p",{className:"text-sm text-gray-700",children:t.description})}),t.input.length>0&&s.jsx(R,{title:"Input Fields",children:s.jsx("ul",{className:"space-y-2",children:t.input.map(o=>s.jsxs("li",{className:"text-xs",children:[s.jsx("code",{className:"text-primary-600",children:o.name}),s.jsxs("span",{className:"text-gray-500",children:[" : ",o.type]}),o.required&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"}),o.description&&s.jsx("p",{className:"text-gray-500 mt-0.5",children:o.description})]},o.name))})})]});case"api":return s.jsx("div",{className:"space-y-4",children:s.jsx(R,{title:"Curl Command",children:s.jsx(qe,{code:a})})});case"examples":return s.jsxs("div",{className:"space-y-4",children:[n&&s.jsx(R,{title:"Request Body",children:s.jsx(qe,{code:JSON.stringify(n,null,2)})}),s.jsx(R,{title:"Response",children:s.jsx(qe,{code:JSON.stringify({module:e.module,data:t.type==="delete"?null:we(e)},null,2)})})]});default:return null}}function R({title:t,children:e}){return s.jsxs("div",{children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:t}),e]})}function Qs({method:t}){const e={GET:"bg-green-100 text-green-700",POST:"bg-blue-100 text-blue-700",PUT:"bg-amber-100 text-amber-700",PATCH:"bg-orange-100 text-orange-700",DELETE:"bg-red-100 text-red-700"};return s.jsx("span",{className:`inline-block px-1.5 py-0.5 text-xs font-mono font-medium rounded ${e[t]||"bg-gray-100 text-gray-700"}`,children:t})}function qe({code:t}){const[e,r]=f.useState(!1),n=()=>{navigator.clipboard.writeText(t),r(!0),setTimeout(()=>r(!1),2e3)};return s.jsxs("div",{className:"relative group",children:[s.jsx("pre",{className:"bg-gray-900 text-gray-100 text-xs p-3 rounded-lg overflow-x-auto",children:s.jsx("code",{children:t})}),s.jsx("button",{onClick:n,className:"absolute top-2 right-2 p-1 bg-gray-700 rounded opacity-0 group-hover:opacity-100 transition-opacity",title:"Copy to clipboard",children:e?s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):s.jsx("svg",{className:"w-4 h-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})}function G(t){const e={api:"API",api_key:"API Key",api_keys:"API Keys",id:"ID",url:"URL",uuid:"UUID",sse:"SSE",http:"HTTP"};return e[t.toLowerCase()]?e[t.toLowerCase()]:t.split("_").map(r=>{const n=r.toLowerCase();return e[n]?e[n]:r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()}).join(" ")}function tn(){const{isExpanded:t}=ot();return s.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[s.jsxs("header",{className:"bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("svg",{className:"w-8 h-8 text-primary-600",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"})}),s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"APIGate"}),s.jsx("span",{className:"text-xs bg-primary-100 text-primary-700 px-2 py-0.5 rounded-full",children:"Admin"})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("a",{href:"/mod/_schema",target:"_blank",className:"text-sm text-gray-500 hover:text-gray-700",children:"Schema API"}),s.jsx("a",{href:"/swagger",target:"_blank",className:"text-sm text-gray-500 hover:text-gray-700",children:"Swagger"})]})]}),s.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[s.jsx(sn,{}),s.jsx("main",{className:`flex-1 overflow-y-auto p-6 transition-all ${t?"mr-80":""}`,children:s.jsx(Hs,{})}),s.jsx("div",{className:"fixed right-0 top-[57px] bottom-0",children:s.jsx(Jr,{})})]})]})}function sn(){const{data:t,isLoading:e,error:r}=Z({queryKey:["modules"],queryFn:Qt});return s.jsxs("aside",{className:"w-56 bg-white border-r border-gray-200 flex flex-col",children:[s.jsxs("nav",{className:"p-4 border-b border-gray-100 space-y-1",children:[s.jsxs(gt,{to:"/",end:!0,className:({isActive:n})=>`flex items-center gap-2 px-3 py-2 rounded-lg text-sm transition-colors ${n?"bg-primary-50 text-primary-700 font-medium":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Dashboard"]}),s.jsxs(gt,{to:"/usage",className:({isActive:n})=>`flex items-center gap-2 px-3 py-2 rounded-lg text-sm transition-colors ${n?"bg-primary-50 text-primary-700 font-medium":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Usage Analytics"]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[s.jsx("h2",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Modules"}),e&&s.jsx("div",{className:"text-sm text-gray-500 px-3",children:"Loading..."}),r&&s.jsx("div",{className:"text-sm text-red-500 px-3",children:"Failed to load modules"}),t&&s.jsx("nav",{className:"space-y-1",children:t.map(n=>s.jsxs(gt,{to:`/${n.module}`,className:({isActive:a})=>`flex items-center gap-2 px-3 py-2 rounded-lg text-sm transition-colors ${a?"bg-primary-50 text-primary-700 font-medium":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[s.jsx(rn,{module:n.module}),s.jsx("span",{children:G(n.plural)})]},n.module))})]}),s.jsx("div",{className:"p-4 border-t border-gray-100",children:s.jsx("p",{className:"text-xs text-gray-400 text-center",children:"APIGate v1.0.0"})})]})}function rn({module:t}){return{user:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),plan:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),api_key:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),route:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),upstream:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2"})})}[t]||s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})}function nn(){const{data:t,isLoading:e,error:r}=Z({queryKey:["modules"],queryFn:Qt});return e?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"flex items-center gap-3 text-gray-500",children:[s.jsxs("svg",{className:"animate-spin w-5 h-5",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading modules..."]})}):r?s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[s.jsx("svg",{className:"w-12 h-12 mx-auto text-red-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("h3",{className:"text-lg font-medium text-red-800 mb-2",children:"Failed to load modules"}),s.jsx("p",{className:"text-red-600",children:"Please check that the API server is running."})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),s.jsx("p",{className:"text-gray-500",children:"Manage your API resources"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:t==null?void 0:t.map(n=>s.jsx(an,{module:n},n.module))}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),s.jsxs("div",{className:"flex flex-wrap gap-3",children:[s.jsxs(K,{to:"/users/new",className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),"Add User"]}),s.jsxs(K,{to:"/plans/new",className:"inline-flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"Create Plan"]}),s.jsxs(K,{to:"/api_key/new",className:"inline-flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),"Generate Key"]})]})]}),s.jsxs("div",{className:"bg-gradient-to-r from-primary-500 to-primary-600 rounded-lg shadow-sm p-6 text-white",children:[s.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Schema API"}),s.jsx("p",{className:"text-primary-100 mb-4",children:"Access the module schema API for integration and documentation."}),s.jsxs("div",{className:"flex flex-wrap gap-3",children:[s.jsxs("a",{href:"/mod/_schema",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 bg-white/20 rounded-lg hover:bg-white/30 transition-colors text-sm",children:[s.jsx("code",{children:"/mod/_schema"}),s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),s.jsxs("a",{href:"/swagger",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 bg-white/20 rounded-lg hover:bg-white/30 transition-colors text-sm",children:["Swagger UI",s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})]})}function an({module:t}){const{data:e}=Z({queryKey:["records",t.plural,{limit:1}],queryFn:()=>Bt(t.plural,{limit:1}),staleTime:3e4});return s.jsxs(K,{to:`/${t.module}`,"data-testid":"module-card","data-module":t.module,className:"block bg-white rounded-lg shadow-sm border border-gray-200 p-5 hover:shadow-md hover:border-primary-300 transition-all",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:G(t.plural)}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:t.description||`Manage ${G(t.plural)}`})]}),s.jsx("div",{className:"text-2xl font-bold text-primary-600",children:(e==null?void 0:e.count)??"-"})]}),s.jsxs("div",{className:"mt-4 flex items-center text-sm text-primary-600",children:["View all",s.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})}function on({module:t,records:e,isLoading:r,onDelete:n,onAction:a}){const{focusModule:o,focusField:l}=ot(),[c,h]=f.useState(null),[x,v]=f.useState("asc"),u=f.useMemo(()=>t.fields.filter(m=>!m.internal&&m.type!=="secret"&&m.type!=="bytes"),[t.fields]),y=f.useMemo(()=>t.actions.filter(m=>m.type==="custom"),[t.actions]),p=f.useMemo(()=>c?[...e].sort((m,j)=>{const b=m[c],C=j[c];if(b===C)return 0;if(b==null)return 1;if(C==null)return-1;const k=String(b).localeCompare(String(C));return x==="asc"?k:-k}):e,[e,c,x]),d=m=>{c===m?v(j=>j==="asc"?"desc":"asc"):(h(m),v("asc"))};return qt.useEffect(()=>{o(t)},[t,o]),r?s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:s.jsxs("div",{className:"flex items-center justify-center gap-3 text-gray-500",children:[s.jsxs("svg",{className:"animate-spin w-5 h-5",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]})}):e.length===0?s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center",children:[s.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),s.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["No ",t.plural," found"]}),s.jsxs("p",{className:"text-gray-500 mb-4",children:["Get started by creating a new ",t.module,"."]}),s.jsxs(K,{to:`/${t.module}/new`,className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create ",t.module]})]}):s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[u.map(m=>s.jsx("th",{onClick:()=>d(m.name),onMouseEnter:()=>l(m,t),className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",children:s.jsxs("div",{className:"flex items-center gap-1",children:[is(m.name),c===m.name&&s.jsx("svg",{className:`w-4 h-4 ${x==="desc"?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})]})},m.name)),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(m=>s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[u.map(j=>s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 whitespace-nowrap",children:ln(m[j.name],j)},j.name)),s.jsx("td",{className:"px-4 py-3 text-right text-sm whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx(K,{to:`/${t.module}/${m.id}`,className:"text-primary-600 hover:text-primary-800",title:"View",children:s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),y.map(j=>s.jsx("button",{onClick:()=>a==null?void 0:a(j.name,String(m.id)),className:cn(j.name),title:j.description||is(j.name),children:un(j.name)},j.name)),n&&s.jsx("button",{onClick:()=>n(String(m.id)),className:"text-red-400 hover:text-red-600",title:"Delete",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},String(m.id)))})]})}),s.jsx("div",{className:"px-4 py-3 border-t border-gray-200 bg-gray-50 flex items-center justify-between",children:s.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",e.length," ",t.plural]})})]})}function is(t){return t.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function ln(t,e){if(t==null)return s.jsx("span",{className:"text-gray-400",children:"-"});switch(e.type){case"bool":return s.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${t?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:t?"Yes":"No"});case"enum":return s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-primary-100 text-primary-800",children:String(t)});case"datetime":return new Date(String(t)).toLocaleString();case"date":return new Date(String(t)).toLocaleDateString();case"email":return s.jsx("a",{href:`mailto:${t}`,className:"text-primary-600 hover:underline",children:String(t)});case"url":return s.jsx("a",{href:String(t),target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:underline",children:dt(String(t),30)});case"json":return s.jsx("code",{className:"text-xs bg-gray-100 px-1 rounded",children:dt(JSON.stringify(t),30)});case"ref":return s.jsx("span",{className:"text-gray-600",children:dt(String(t),20)});default:return dt(String(t),40)}}function dt(t,e){return t.length<=e?t:t.slice(0,e)+"..."}function cn(t){const e=t.toLowerCase();return e.includes("enable")||e.includes("activate")?"text-green-400 hover:text-green-600":e.includes("disable")||e.includes("suspend")||e.includes("cancel")?"text-orange-400 hover:text-orange-600":e.includes("revoke")?"text-red-400 hover:text-red-600":"text-gray-400 hover:text-gray-600"}function un(t){const e=t.toLowerCase();return e.includes("enable")||e.includes("activate")?s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}):e.includes("disable")||e.includes("suspend")?s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})}):e.includes("cancel")||e.includes("revoke")?s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):e.includes("default")||e.includes("set")?s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}):s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}function dn(){var j;const{module:t}=js(),e=it(),[r,n]=f.useState(null),[a,o]=f.useState(null),{data:l,isLoading:c}=Z({queryKey:["schema",t],queryFn:()=>Ds(t),enabled:!!t}),{data:h,isLoading:x}=Z({queryKey:["records",t],queryFn:()=>Bt(l.plural,{limit:100}),enabled:!!t&&!!l}),v=et({mutationFn:b=>Qr(l.plural,b),onSuccess:()=>{e.invalidateQueries({queryKey:["records",t]}),n(null)}}),u=et({mutationFn:({action:b,id:C})=>$s(l.plural,b,C),onSuccess:()=>{e.invalidateQueries({queryKey:["records",t]}),o(null)}}),y=b=>{n(b)},p=()=>{r&&v.mutate(r)},d=(b,C)=>{const k=l==null?void 0:l.actions.find(w=>w.name===b);k!=null&&k.confirm?o({action:b,id:C}):u.mutate({action:b,id:C})},m=()=>{a&&u.mutate(a)};return c?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"flex items-center gap-3 text-gray-500",children:[s.jsxs("svg",{className:"animate-spin w-5 h-5",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]})}):l?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:G(l.plural)}),s.jsx("p",{className:"text-gray-500",children:l.description||`Manage ${G(l.plural)}`})]}),s.jsxs(K,{to:`/${t}/new`,className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create ",G(l.module)]})]}),s.jsx(on,{module:l,records:(h==null?void 0:h.data)||[],isLoading:x,onDelete:y,onAction:d}),r&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Confirm Delete"}),s.jsxs("p",{className:"text-gray-600 mb-6",children:["Are you sure you want to delete this ",G(l.module).toLowerCase(),"? This action cannot be undone."]}),s.jsxs("div",{className:"flex items-center justify-end gap-3",children:[s.jsx("button",{onClick:()=>n(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:p,disabled:v.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 disabled:opacity-50",children:v.isPending?"Deleting...":"Delete"})]})]})}),a&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["Confirm ",bt(a.action)]}),s.jsx("p",{className:"text-gray-600 mb-6",children:((j=l.actions.find(b=>b.name===a.action))==null?void 0:j.description)||`Are you sure you want to ${bt(a.action).toLowerCase()} this ${G(l.module).toLowerCase()}?`}),s.jsxs("div",{className:"flex items-center justify-end gap-3",children:[s.jsx("button",{onClick:()=>o(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:m,disabled:u.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-lg hover:bg-primary-700 disabled:opacity-50",children:u.isPending?"Processing...":bt(a.action)})]})]})})]}):s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[s.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Module not found"}),s.jsxs("p",{className:"text-red-600",children:['The module "',t,'" does not exist.']})]})}function bt(t){return t.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function os(t){const e=["name","title","email","label","slug"];for(const r of e)if(t[r]&&typeof t[r]=="string")return t[r];return String(t.id||"Unknown")}function hn({targetModule:t,value:e,onChange:r,disabled:n,className:a="",placeholder:o,hasError:l}){var d;const{data:c}=Z({queryKey:["modules"],queryFn:Qt,staleTime:3e5}),h=((d=c==null?void 0:c.find(m=>m.module===t))==null?void 0:d.plural)||`${t}s`,{data:x,isLoading:v,error:u}=Z({queryKey:["records",h],queryFn:()=>Bt(h,{limit:100}),enabled:!!h,staleTime:30*1e3}),y=(x==null?void 0:x.data)||[],p=`
    w-full px-3 py-2 border rounded-lg text-sm
    focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent
    transition-colors
    ${l?"border-red-300 bg-red-50":"border-gray-300 bg-white"}
    ${n?"bg-gray-100 text-gray-500 cursor-not-allowed":""}
    ${a}
  `.trim();return v?s.jsxs("div",{className:"relative",children:[s.jsx("select",{disabled:!0,className:p,children:s.jsxs("option",{children:["Loading ",t,"s..."]})}),s.jsx("div",{className:"absolute right-8 top-1/2 -translate-y-1/2",children:s.jsxs("svg",{className:"animate-spin w-4 h-4 text-gray-400",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]})})]}):u?s.jsxs("div",{className:"text-sm text-red-500",children:["Failed to load ",t,"s: ",u instanceof Error?u.message:"Unknown error"]}):y.length===0?s.jsxs("div",{className:"text-sm text-amber-600 bg-amber-50 border border-amber-200 rounded-lg px-3 py-2",children:["No ",t,"s available. Please create a ",t," first."]}):s.jsxs("select",{value:e||"",onChange:m=>r(m.target.value||null),disabled:n,className:p,children:[s.jsx("option",{value:"",children:o||`Select ${t}...`}),y.map(m=>s.jsxs("option",{value:String(m.id),children:[os(m),m.id!==os(m)&&` (${m.id})`]},String(m.id)))]})}const mn=f.forwardRef(function({field:e,module:r,value:n,onChange:a,error:o,disabled:l},c){var p;const h=qr(e,r),x=`
      w-full px-3 py-2 border rounded-lg text-sm
      focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent
      transition-colors
      ${o?"border-red-300 bg-red-50":"border-gray-300 bg-white"}
      ${l?"bg-gray-100 text-gray-500 cursor-not-allowed":""}
    `,v=s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[ht(e.name),e.required&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"}),e.computed&&s.jsx("span",{className:"text-gray-400 ml-1 text-xs",children:"(auto)"})]}),u=o&&s.jsx("p",{className:"mt-1 text-xs text-red-500",children:o}),y=e.description&&s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:e.description});switch(e.type){case"bool":return s.jsxs("div",{className:"mb-4",...h,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{ref:c,type:"checkbox",checked:!!n,onChange:d=>a(d.target.checked),disabled:l||e.computed,className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),s.jsxs("label",{className:"text-sm font-medium text-gray-700",children:[ht(e.name),e.required&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"})]})]}),y,u]});case"enum":return s.jsxs("div",{className:"mb-4",...h,children:[v,s.jsxs("select",{value:String(n??""),onChange:d=>a(d.target.value),disabled:l||e.computed,className:x,children:[s.jsxs("option",{value:"",children:["Select ",ht(e.name),"..."]}),(p=e.values)==null?void 0:p.map(d=>s.jsx("option",{value:d,children:d},d))]}),y,u]});case"text":case"json":return s.jsxs("div",{className:"mb-4",...h,children:[v,s.jsx("textarea",{value:e.type==="json"?xn(n):String(n??""),onChange:d=>a(e.type==="json"?pn(d.target.value):d.target.value),disabled:l||e.computed,rows:4,className:x}),y,u]});case"secret":return s.jsxs("div",{className:"mb-4",...h,children:[v,s.jsx("input",{ref:c,type:"password",value:String(n??""),onChange:d=>a(d.target.value),disabled:l||e.computed,className:x,autoComplete:"new-password"}),y,u]});case"email":return s.jsxs("div",{className:"mb-4",...h,children:[v,s.jsx("input",{ref:c,type:"email",value:String(n??""),onChange:d=>a(d.target.value),disabled:l||e.computed,className:x,placeholder:"user@example.com"}),y,u]});case"url":return s.jsxs("div",{className:"mb-4",...h,children:[v,s.jsx("input",{ref:c,type:"url",value:String(n??""),onChange:d=>a(d.target.value),disabled:l||e.computed,className:x,placeholder:"https://example.com"}),y,u]});case"int":return s.jsxs("div",{className:"mb-4",...h,children:[v,s.jsx("input",{ref:c,type:"number",value:n!=null?String(n):"",onChange:d=>a(d.target.value?parseInt(d.target.value,10):null),disabled:l||e.computed,className:x,step:"1"}),y,u]});case"float":return s.jsxs("div",{className:"mb-4",...h,children:[v,s.jsx("input",{ref:c,type:"number",value:n!=null?String(n):"",onChange:d=>a(d.target.value?parseFloat(d.target.value):null),disabled:l||e.computed,className:x,step:"any"}),y,u]});case"datetime":return s.jsxs("div",{className:"mb-4",...h,children:[v,s.jsx("input",{ref:c,type:"datetime-local",value:fn(n),onChange:d=>a(d.target.value?new Date(d.target.value).toISOString():null),disabled:l||e.computed,className:x}),y,u]});case"date":return s.jsxs("div",{className:"mb-4",...h,children:[v,s.jsx("input",{ref:c,type:"date",value:String(n??""),onChange:d=>a(d.target.value),disabled:l||e.computed,className:x}),y,u]});case"time":return s.jsxs("div",{className:"mb-4",...h,children:[v,s.jsx("input",{ref:c,type:"time",value:String(n??""),onChange:d=>a(d.target.value),disabled:l||e.computed,className:x}),y,u]});case"ref":return s.jsxs("div",{className:"mb-4",...h,children:[v,s.jsx(hn,{targetModule:e.ref||"",value:n,onChange:d=>a(d),disabled:l||e.computed,hasError:!!o,placeholder:`Select ${ht(e.ref||"reference")}...`}),y,u]});case"string":default:return s.jsxs("div",{className:"mb-4",...h,children:[v,s.jsx("input",{ref:c,type:"text",value:String(n??""),onChange:d=>a(d.target.value),disabled:l||e.computed,className:x}),y,u]})}});function ht(t){return t.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function xn(t){return t==null?"":typeof t=="string"?t:JSON.stringify(t,null,2)}function pn(t){try{return JSON.parse(t)}catch{return t}}function fn(t){if(!t)return"";try{return new Date(String(t)).toISOString().slice(0,16)}catch{return""}}function yn({module:t,initialData:e={},mode:r,onSubmit:n,onCancel:a,isLoading:o}){const{focusModule:l}=ot(),[c,h]=f.useState(()=>{if(r==="edit")return e;const b={...e};for(const C of t.fields)C.default!==void 0&&b[C.name]===void 0&&(b[C.name]=C.default);return b}),[x,v]=f.useState({}),[u,y]=f.useState(null),p=f.useMemo(()=>t.fields.filter(b=>!(b.implicit||b.internal||b.computed||r==="edit"&&b.immutable)),[t.fields,r]),d=f.useCallback((b,C)=>{h(k=>({...k,[b]:C})),x[b]&&v(k=>{const w={...k};return delete w[b],w})},[x]),m=f.useCallback(()=>{const b={};for(const C of p){const k=c[C.name];if(C.required&&(k==null||k==="")){b[C.name]=`${gn(C.name)} is required`;continue}if(k!=null&&k!==""){const w=bn(C,k);w&&(b[C.name]=w)}}return v(b),Object.keys(b).length===0},[p,c]),j=async b=>{if(b.preventDefault(),y(null),!!m())try{await n(c)}catch(C){y(C instanceof Error?C.message:"An error occurred")}};return qt.useEffect(()=>{l(t)},[t,l]),s.jsxs("form",{onSubmit:j,className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:r==="create"?`Create ${G(t.module)}`:`Edit ${G(t.module)}`}),p.map(b=>s.jsx(mn,{field:b,module:t,value:c[b.name],onChange:C=>d(b.name,C),error:x[b.name],disabled:o},b.name))]}),u&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("p",{className:"text-sm text-red-700",children:u})]})}),s.jsxs("div",{className:"flex items-center justify-end gap-3",children:[a&&s.jsx("button",{type:"button",onClick:a,disabled:o,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50",children:"Cancel"}),s.jsxs("button",{type:"submit",disabled:o,className:"px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50 flex items-center gap-2",children:[o&&s.jsxs("svg",{className:"animate-spin w-4 h-4",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r==="create"?"Create":"Save Changes"]})]})]})}function gn(t){return t.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function bn(t,e){switch(t.type){case"email":if(typeof e=="string"&&!vn(e))return"Please enter a valid email address";break;case"url":if(typeof e=="string"&&!jn(e))return"Please enter a valid URL";break;case"enum":if(t.values&&!t.values.includes(String(e)))return`Must be one of: ${t.values.join(", ")}`;break}if(t.constraints)for(const r of t.constraints)switch(r.type){case"min_length":if(typeof e=="string"&&e.length<Number(r.value))return r.message||`Must be at least ${r.value} characters`;break;case"max_length":if(typeof e=="string"&&e.length>Number(r.value))return r.message||`Must be at most ${r.value} characters`;break;case"min":if(typeof e=="number"&&e<Number(r.value))return r.message||`Must be at least ${r.value}`;break;case"max":if(typeof e=="number"&&e>Number(r.value))return r.message||`Must be at most ${r.value}`;break;case"pattern":if(typeof e=="string")try{const a=String(r.value).replace(/\[([^\]]*)-([^\]]*)\]/g,(o,l,c)=>l&&c?`[${l}\\-${c}]`:o);if(!new RegExp(a).test(e))return r.message||"Invalid format"}catch(n){console.warn(`Invalid regex pattern: ${r.value}`,n)}break}return null}function vn(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}function jn(t){try{return new URL(t),!0}catch{return!1}}function wn({userId:t,userEmail:e,onClose:r,onSuccess:n}){const[a,o]=f.useState(""),[l,c]=f.useState(""),[h,x]=f.useState(""),v=it(),u=et({mutationFn:()=>$s("users","set_password",t,{password:a}),onSuccess:()=>{v.invalidateQueries({queryKey:["records","user"]}),n==null||n(),r()},onError:p=>{x(p instanceof Error?p.message:"Failed to set password")}}),y=p=>{if(p.preventDefault(),x(""),!a){x("Password is required");return}if(a.length<8){x("Password must be at least 8 characters");return}if(a!==l){x("Passwords do not match");return}u.mutate()};return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Set Password"}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Set a new password for ",s.jsx("strong",{children:e})]}),s.jsxs("form",{onSubmit:y,className:"space-y-4",children:[h&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:s.jsx("p",{className:"text-sm text-red-700",children:h})}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),s.jsx("input",{id:"password",type:"password",value:a,onChange:p=>o(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter new password",autoComplete:"new-password",minLength:8}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Must be at least 8 characters"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),s.jsx("input",{id:"confirmPassword",type:"password",value:l,onChange:p=>c(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Confirm new password",autoComplete:"new-password"})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[s.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:u.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-lg hover:bg-primary-700 disabled:opacity-50",children:u.isPending?"Setting...":"Set Password"})]})]})]})})}function Nn(){var k,w,F;const{module:t,id:e}=js(),r=It(),n=it(),a=e==="new",[o,l]=f.useState(null),[c,h]=f.useState(!1),{data:x,isLoading:v}=Z({queryKey:["schema",t],queryFn:()=>Ds(t),enabled:!!t}),{data:u,isLoading:y}=Z({queryKey:["record",t,e],queryFn:()=>$r(x.plural,e),enabled:!!t&&!!e&&!a&&!!x}),p=et({mutationFn:E=>_r(x.plural,E),onSuccess:E=>{var W;n.invalidateQueries({queryKey:["records",t]}),(W=E.meta)!=null&&W.raw_key?l({rawKey:E.meta.raw_key,recordId:E.data.id}):r(`/${t}/${E.data.id}`)}}),d=et({mutationFn:E=>Ur(x.plural,e,E),onSuccess:()=>{n.invalidateQueries({queryKey:["records",t]}),n.invalidateQueries({queryKey:["record",t,e]})}}),m=async E=>{a?await p.mutateAsync(E):await d.mutateAsync(E)},j=()=>{r(`/${t}`)};if(v||!a&&y)return s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"flex items-center gap-3 text-gray-500",children:[s.jsxs("svg",{className:"animate-spin w-5 h-5",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]})});if(!x)return s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[s.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Module not found"}),s.jsxs("p",{className:"text-red-600",children:['The module "',t,'" does not exist.']})]});const b=t==="user",C=(k=u==null?void 0:u.data)==null?void 0:k.email;return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("nav",{className:"flex items-center gap-2 text-sm",children:[s.jsx(K,{to:`/${t}`,className:"text-gray-500 hover:text-gray-700",children:G(x.plural)}),s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),s.jsx("span",{className:"text-gray-900 font-medium",children:a?"Create New":((w=u==null?void 0:u.data)==null?void 0:w.name)||((F=u==null?void 0:u.data)==null?void 0:F.email)||e})]}),b&&!a&&s.jsxs("button",{type:"button",onClick:()=>h(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),"Set Password"]})]}),s.jsx(yn,{module:x,initialData:a?{}:(u==null?void 0:u.data)||{},mode:a?"create":"edit",onSubmit:m,onCancel:j,isLoading:p.isPending||d.isPending}),d.isSuccess&&s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),s.jsx("p",{className:"text-sm text-green-700",children:"Changes saved successfully!"})]})}),o&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"API Key Created"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Copy this key now. You won't be able to see it again!"})]})]}),s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your API Key"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("code",{className:"flex-1 bg-white border border-gray-300 rounded px-3 py-2 text-sm font-mono break-all select-all",children:o.rawKey}),s.jsx("button",{type:"button",onClick:()=>{navigator.clipboard.writeText(o.rawKey)},className:"flex-shrink-0 px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded text-sm font-medium text-gray-700 transition-colors",children:"Copy"})]})]}),s.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-4",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsxs("p",{className:"text-sm text-amber-800",children:[s.jsx("strong",{children:"Important:"})," This is the only time you'll see this key. Store it securely."]})]})}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{type:"button",onClick:()=>{l(null),r(`/${t}/${o.recordId}`)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"I've saved my key"})})]})}),c&&b&&e&&s.jsx(wn,{userId:e,userEmail:C||"Unknown user",onClose:()=>h(!1),onSuccess:()=>{}})]})}async function Cn(t){const e=new URLSearchParams;t!=null&&t.period&&e.set("period",t.period),t!=null&&t.user_id&&e.set("user_id",t.user_id),t!=null&&t.start_date&&e.set("start_date",t.start_date),t!=null&&t.end_date&&e.set("end_date",t.end_date);const r=`/admin/usage${e.toString()?`?${e}`:""}`,n=await fetch(r,{credentials:"include"});if(!n.ok){const a=await n.json().catch(()=>({error:n.statusText}));throw new Error(a.error||"Failed to fetch usage")}return n.json()}function ls(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB","TB"],n=Math.floor(Math.log(t)/Math.log(e));return`${parseFloat((t/Math.pow(e,n)).toFixed(2))} ${r[n]}`}function Xe(t){return t.toLocaleString()}function kn(){const[t,e]=f.useState("month"),{data:r,isLoading:n,error:a}=Z({queryKey:["usage",t],queryFn:()=>Cn({period:t})});return n?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"flex items-center gap-3 text-gray-500",children:[s.jsxs("svg",{className:"animate-spin w-5 h-5",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading analytics..."]})}):a?s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Failed to load analytics"}),s.jsx("p",{className:"text-red-600 mt-1",children:a instanceof Error?a.message:"Unknown error"})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Usage Analytics"}),s.jsx("p",{className:"text-gray-500",children:"Monitor API usage and activity"})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsx(Sn,{value:t,onChange:e})})]}),r&&s.jsx(Pn,{data:r}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(r==null?void 0:r.by_user)&&r.by_user.length>0&&s.jsx(Mn,{users:r.by_user}),(r==null?void 0:r.by_plan)&&r.by_plan.length>0&&s.jsx(Ln,{plans:r.by_plan})]}),r&&(!r.by_user||r.by_user.length===0)&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center",children:[s.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No usage data"}),s.jsx("p",{className:"text-gray-500",children:"Usage data will appear here once API requests are made."})]})]})}function Sn({value:t,onChange:e}){const r=[{value:"day",label:"Last 24 Hours"},{value:"week",label:"Last 7 Days"},{value:"month",label:"Last 30 Days"}];return s.jsx("div",{className:"flex rounded-lg border border-gray-200 bg-white p-1",children:r.map(n=>s.jsx("button",{onClick:()=>e(n.value),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${t===n.value?"bg-primary-100 text-primary-700":"text-gray-600 hover:text-gray-900"}`,children:n.label},n.value))})}function Pn({data:t}){const e=[{label:"Total Requests",value:Xe(t.summary.total_requests),icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),color:"text-primary-600 bg-primary-100"},{label:"Active Users",value:Xe(t.summary.total_users),icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),color:"text-green-600 bg-green-100"},{label:"API Keys",value:Xe(t.summary.total_keys),icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),color:"text-orange-600 bg-orange-100"}];return s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e.map(r=>s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`p-3 rounded-lg ${r.color}`,children:r.icon}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:r.label}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.value})]})]})},r.label))})}function Mn({users:t}){const r=[...t].sort((n,a)=>a.requests-n.requests).slice(0,10);return s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Users by Requests"})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Requests"}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Data In"}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Data Out"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(n=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsxs("td",{className:"px-6 py-4",children:[s.jsx(K,{to:`/users/${n.user_id}`,className:"text-primary-600 hover:underline",children:n.email}),s.jsx("p",{className:"text-xs text-gray-500",children:n.plan_id})]}),s.jsx("td",{className:"px-6 py-4 text-right font-medium",children:Xe(n.requests)}),s.jsx("td",{className:"px-6 py-4 text-right text-gray-600",children:ls(n.bytes_in)}),s.jsx("td",{className:"px-6 py-4 text-right text-gray-600",children:ls(n.bytes_out)})]},n.user_id))})]})}),t.length>10&&s.jsx("div",{className:"px-6 py-3 border-t border-gray-200 bg-gray-50 text-center",children:s.jsxs("span",{className:"text-sm text-gray-500",children:["Showing top 10 of ",t.length," users"]})})]})}function Ln({plans:t}){const e=[...t].sort((n,a)=>a.requests-n.requests),r=e.reduce((n,a)=>n+a.requests,0);return s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Usage by Plan"})}),s.jsx("div",{className:"p-6 space-y-4",children:e.map(n=>{const a=r>0?n.requests/r*100:0;return s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsxs("div",{children:[s.jsx(K,{to:`/plans/${n.plan_id}`,className:"font-medium text-gray-900 hover:text-primary-600",children:n.plan_name}),s.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",n.user_count," users)"]})]}),s.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[Xe(n.requests)," requests"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all",style:{width:`${a}%`}})})]},n.plan_id)})})]})}function Rn(){const[t,e]=f.useState(""),[r,n]=f.useState(""),[a,o]=f.useState(""),[l,c]=f.useState(!1),{login:h}=Je(),x=It(),v=async u=>{u.preventDefault(),o(""),c(!0);try{await h(t,r),x("/")}catch(y){o(y instanceof Error?y.message:"Login failed")}finally{c(!1)}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"max-w-md w-full space-y-8",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-center text-3xl font-bold text-gray-900",children:"APIGate"}),s.jsx("h2",{className:"mt-6 text-center text-2xl font-semibold text-gray-900",children:"Sign in to your account"})]}),s.jsxs("form",{className:"mt-8 space-y-6",onSubmit:v,children:[a&&s.jsx("div",{className:"rounded-md bg-red-50 p-4",children:s.jsx("p",{className:"text-sm text-red-700",children:a})}),s.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),s.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:t,onChange:u=>e(u.target.value),className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"you@example.com"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),s.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:u=>n(u.target.value),className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Password"})]})]}),s.jsx("div",{children:s.jsx("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:l?"Signing in...":"Sign in"})}),s.jsx("div",{className:"text-center",children:s.jsxs("span",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",s.jsx(K,{to:"/register",className:"font-medium text-blue-600 hover:text-blue-500",children:"Sign up"})]})})]})]})})}function En(){const[t,e]=f.useState(""),[r,n]=f.useState(""),[a,o]=f.useState(""),[l,c]=f.useState(""),[h,x]=f.useState(!1),{register:v}=Je(),u=It(),y=async p=>{if(p.preventDefault(),c(""),r.length<8){c("Password must be at least 8 characters");return}x(!0);try{await v(t,r,a),u("/")}catch(d){c(d instanceof Error?d.message:"Registration failed")}finally{x(!1)}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"max-w-md w-full space-y-8",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-center text-3xl font-bold text-gray-900",children:"APIGate"}),s.jsx("h2",{className:"mt-6 text-center text-2xl font-semibold text-gray-900",children:"Create your account"})]}),s.jsxs("form",{className:"mt-8 space-y-6",onSubmit:y,children:[l&&s.jsx("div",{className:"rounded-md bg-red-50 p-4",children:s.jsx("p",{className:"text-sm text-red-700",children:l})}),s.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),s.jsx("input",{id:"name",name:"name",type:"text",autoComplete:"name",value:a,onChange:p=>o(p.target.value),className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Your name"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),s.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:t,onChange:p=>e(p.target.value),className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"you@example.com"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),s.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,value:r,onChange:p=>n(p.target.value),className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"At least 8 characters"})]})]}),s.jsx("div",{children:s.jsx("button",{type:"submit",disabled:h,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:h?"Creating account...":"Create account"})}),s.jsx("div",{className:"text-center",children:s.jsxs("span",{className:"text-sm text-gray-600",children:["Already have an account?"," ",s.jsx(K,{to:"/login",className:"font-medium text-blue-600 hover:text-blue-500",children:"Sign in"})]})})]})]})})}function On(){const[t,e]=f.useState(""),[r,n]=f.useState(""),[a,o]=f.useState(""),[l,c]=f.useState(""),[h,x]=f.useState(""),[v,u]=f.useState(!1),{setup:y}=Je(),p=async d=>{if(d.preventDefault(),x(""),r.length<8){x("Password must be at least 8 characters");return}if(r!==a){x("Passwords do not match");return}u(!0);try{await y(t,r,l)}catch(m){x(m instanceof Error?m.message:"Setup failed")}finally{u(!1)}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 py-12 px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-xl shadow-lg",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mx-auto h-16 w-16 bg-blue-600 rounded-xl flex items-center justify-center",children:s.jsx("svg",{className:"h-10 w-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx("h1",{className:"mt-4 text-3xl font-bold text-gray-900",children:"Welcome to APIGate"}),s.jsx("p",{className:"mt-2 text-gray-600",children:"Let's set up your admin account to get started"})]}),s.jsxs("form",{className:"mt-8 space-y-6",onSubmit:p,children:[h&&s.jsx("div",{className:"rounded-md bg-red-50 p-4 border border-red-200",children:s.jsx("p",{className:"text-sm text-red-700",children:h})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Your Name"}),s.jsx("input",{id:"name",name:"name",type:"text",autoComplete:"name",value:l,onChange:d=>c(d.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent sm:text-sm",placeholder:"John Doe"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),s.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:t,onChange:d=>e(d.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent sm:text-sm",placeholder:"admin@example.com"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),s.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,value:r,onChange:d=>n(d.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent sm:text-sm",placeholder:"At least 8 characters"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),s.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,value:a,onChange:d=>o(d.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent sm:text-sm",placeholder:"Confirm your password"})]})]}),s.jsx("div",{children:s.jsx("button",{type:"submit",disabled:v,className:"w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 transition-colors",children:v?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Setting up..."]}):"Complete Setup"})})]}),s.jsx("div",{className:"mt-6 border-t border-gray-200 pt-6",children:s.jsx("p",{className:"text-xs text-gray-500 text-center",children:"This will create your admin account. You can add more users later from the dashboard."})})]})})}function Ht(){return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})})}function Fn({children:t}){const{isAuthenticated:e,isLoading:r,setupRequired:n}=Je();return r?s.jsx(Ht,{}):n?s.jsx(Oe,{to:"/setup",replace:!0}):e?s.jsx(s.Fragment,{children:t}):s.jsx(Oe,{to:"/login",replace:!0})}function cs({children:t}){const{isAuthenticated:e,isLoading:r,setupRequired:n}=Je();return r?s.jsx(Ht,{}):n?s.jsx(Oe,{to:"/setup",replace:!0}):e?s.jsx(Oe,{to:"/",replace:!0}):s.jsx(s.Fragment,{children:t})}function An({children:t}){const{isLoading:e,setupRequired:r,isAuthenticated:n}=Je();return e?s.jsx(Ht,{}):r?s.jsx(s.Fragment,{children:t}):n?s.jsx(Oe,{to:"/",replace:!0}):s.jsx(Oe,{to:"/login",replace:!0})}function Tn(){return s.jsxs(Ws,{children:[s.jsx(ee,{path:"/setup",element:s.jsx(An,{children:s.jsx(On,{})})}),s.jsx(ee,{path:"/login",element:s.jsx(cs,{children:s.jsx(Rn,{})})}),s.jsx(ee,{path:"/register",element:s.jsx(cs,{children:s.jsx(En,{})})}),s.jsxs(ee,{path:"/",element:s.jsx(Fn,{children:s.jsx(tn,{})}),children:[s.jsx(ee,{index:!0,element:s.jsx(nn,{})}),s.jsx(ee,{path:"usage",element:s.jsx(kn,{})}),s.jsx(ee,{path:":module",element:s.jsx(dn,{})}),s.jsx(ee,{path:":module/:id",element:s.jsx(Nn,{})})]}),s.jsx(ee,{path:"*",element:s.jsx(Oe,{to:"/",replace:!0})})]})}function qn(){return s.jsx(Ir,{children:s.jsx(Tr,{children:s.jsx(Ks,{basename:"/mod/ui",children:s.jsx(Tn,{})})})})}const In=new wr({defaultOptions:{queries:{staleTime:3e4,retry:1}}});vt.createRoot(document.getElementById("root")).render(s.jsx(qt.StrictMode,{children:s.jsx(Nr,{client:In,children:s.jsx(qn,{})})}));
